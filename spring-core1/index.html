<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>스프링 핵심 원리 복습 일지#1 - h3yon blog</title><meta name="Description" content="Welcome to h3yon 개구리 블로그"><meta property="og:title" content="스프링 핵심 원리 복습 일지#1" />
<meta property="og:description" content="스프링 핵심 원리(기본편) 생성일: 2022년 4월 10일 오후 5:00
0. 객체 지향 설계와 스프링 EJB(Enterprise Java Beans)
 트랜잭션이 좋다. 분산 기술이 좋았다. 엔티티빈(JPA ORM)도 가지고 있었다. 비용이 비싸다. 어렵고 복잡하고 느리다(EJB에 의존적으로 코드를 짜야 한다, 컨테이너 띄우는 게 느리다).  → 순수하게 자바로 돌아가자. (POJO Plain Old Java Object)
로드존슨이 EJB를 비판하면서 미래 스프링의 기틀을 다져준다. 링킹이 Hibernate 등장. 자바 표준 JPA 구현체로 사용될 수 있다.
JPA(인터페이스)
→ Hibernate, EclipseLink, 기타, &hellip;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://h3yon.github.io/spring-core1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-14T23:56:34+09:00" />
<meta property="article:modified_time" content="2022-04-14T23:56:34+09:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="스프링 핵심 원리 복습 일지#1"/>
<meta name="twitter:description" content="스프링 핵심 원리(기본편) 생성일: 2022년 4월 10일 오후 5:00
0. 객체 지향 설계와 스프링 EJB(Enterprise Java Beans)
 트랜잭션이 좋다. 분산 기술이 좋았다. 엔티티빈(JPA ORM)도 가지고 있었다. 비용이 비싸다. 어렵고 복잡하고 느리다(EJB에 의존적으로 코드를 짜야 한다, 컨테이너 띄우는 게 느리다).  → 순수하게 자바로 돌아가자. (POJO Plain Old Java Object)
로드존슨이 EJB를 비판하면서 미래 스프링의 기틀을 다져준다. 링킹이 Hibernate 등장. 자바 표준 JPA 구현체로 사용될 수 있다.
JPA(인터페이스)
→ Hibernate, EclipseLink, 기타, &hellip;"/>
<meta name="application-name" content="h3yon blog">
<meta name="apple-mobile-web-app-title" content="h3yon blog"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://h3yon.github.io/spring-core1/" /><link rel="prev" href="https://h3yon.github.io/effective-java/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "스프링 핵심 원리 복습 일지#1",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/h3yon.github.io\/spring-core1\/"
        },"genre": "posts","keywords": "spring","wordcount":  1534 ,
        "url": "https:\/\/h3yon.github.io\/spring-core1\/","datePublished": "2022-04-14T23:56:34+09:00","dateModified": "2022-04-14T23:56:34+09:00","publisher": {
            "@type": "Organization",
            "name": "h3yon"},"author": {
                "@type": "Person",
                "name": "h3yon"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="h3yon blog">h3yon blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="h3yon blog">h3yon blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">스프링 핵심 원리 복습 일지#1</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/h3yon" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>h3yon</a></span>&nbsp;<span class="post-category">included in <a href="/categories/spring/"><i class="far fa-folder fa-fw"></i>spring</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-04-14">2022-04-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1534 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;8 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#0-객체-지향-설계와-스프링">0. 객체 지향 설계와 스프링</a></li>
    <li><a href="#1-스프링-핵심-원리-이해1---예제-만들기">1. 스프링 핵심 원리 이해1 - 예제 만들기</a></li>
    <li><a href="#2-스프링-핵심-원리-이해2---객체-지향-원리-적용">2. <strong>스프링 핵심 원리 이해2 - 객체 지향 원리 적용</strong></a></li>
    <li><a href="#3-스프링-컨테이너와-스프링-빈">3. <strong>스프링 컨테이너와 스프링 빈</strong></a></li>
    <li><a href="#4-싱글톤-컨테이너">4. <strong>싱글톤 컨테이너</strong></a>
      <ul>
        <li><a href="#싱글톤-패턴">싱글톤 패턴</a></li>
        <li><a href="#싱글톤-컨테이너">싱글톤 컨테이너</a></li>
        <li><a href="#주의점">주의점</a></li>
        <li><a href="#configuration과-싱글톤"><strong>@Configuration과 싱글톤</strong></a></li>
        <li><a href="#configuration-을-적용하지-않고-bean-만-적용하면-어떻게-될까"><strong>@Configuration 을 적용하지 않고, @Bean 만 적용하면 어떻게 될까?</strong></a></li>
      </ul>
    </li>
    <li><a href="#5-컴포넌트-스캔">5. 컴포넌트 스캔</a>
      <ul>
        <li><a href="#컴포넌트-스캔-기본-대상">컴포넌트 스캔 기본 대상</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="스프링-핵심-원리기본편">스프링 핵심 원리(기본편)</h1>
<p>생성일: 2022년 4월 10일 오후 5:00</p>
<h2 id="0-객체-지향-설계와-스프링">0. 객체 지향 설계와 스프링</h2>
<p><strong>EJB(Enterprise Java Beans)</strong></p>
<ul>
<li>트랜잭션이 좋다. 분산 기술이 좋았다. 엔티티빈(JPA ORM)도 가지고 있었다.</li>
<li>비용이 비싸다. 어렵고 복잡하고 느리다(EJB에 의존적으로 코드를 짜야 한다, 컨테이너 띄우는 게 느리다).</li>
</ul>
<p>→ 순수하게 자바로 돌아가자. (POJO Plain Old Java Object)</p>
<p>로드존슨이 EJB를 비판하면서 미래 스프링의 기틀을 다져준다.
링킹이 Hibernate 등장. 자바 표준 JPA 구현체로 사용될 수 있다.</p>
<p>JPA(인터페이스)</p>
<p>→ Hibernate, EclipseLink, 기타, &hellip;</p>
<ul>
<li>스프링 오픈소스 제안 → EJB란 겨울을 넘어 새로운 시작으로 지음</li>
</ul>
<p><strong>스프링 역사</strong></p>
<p>2003~2006. (Spring Framework 1.0~2.0) - XML
2009~2013. (Spring Framework 3.0~4.0) - 자바
2014. Spring Boot 1.0 출시
2017. Spring Framework 5.0, Spring Boot 2.0(리액티브 프로그래밍 지원)
2020. Spring Framework 5.2, Spring Boot 2.3.x</p>
<p><strong>스프링</strong></p>
<p><a href="https://spring.io/projects" target="_blank" rel="noopener noreffer">https://spring.io/projects</a></p>
<ul>
<li>핵심. 스프링 프레임워크</li>
<li>편의기능. 스프링 부트</li>
<li>(선택)
스프링 데이터, -(MongoDB, NoSQL, Redis 기본 CRUD 지원)
스프링 세션, 스프링 시큐리티, 스프링 Rest Docs,
스프링 배치,  - (천만명 데이터를 한번에 업데이트 힘듦. 천건씩 돌리고 저장하고. 배치)
스프링 클라우드
etc</li>
</ul>
<p><strong>스프링 프레임워크와 스프링 부트</strong></p>
<table>
<thead>
<tr>
<th>스프링 프레임워크</th>
<th>스프링 부트</th>
</tr>
</thead>
<tbody>
<tr>
<td>핵심: DI Container, AOP, event</td>
<td></td>
</tr>
<tr>
<td>웹: MVC, WebFlux</td>
<td></td>
</tr>
<tr>
<td>데이터 접근: Transaction, JDBC, ORM, XML</td>
<td></td>
</tr>
<tr>
<td>기술통합</td>
<td></td>
</tr>
<tr>
<td>테스트</td>
<td></td>
</tr>
<tr>
<td>언어</td>
<td>(스프링 부트를 통해 스프링 프레임워크 사용하는 게 다수)</td>
</tr>
<tr>
<td>Tomcat 같은 웹서버 내장</td>
<td></td>
</tr>
<tr>
<td>starter 종속성 제공(손쉬운 빌드)</td>
<td></td>
</tr>
<tr>
<td>스프링과 써드 라이브러리 자동 구성(외부 라이브러리 버전)</td>
<td></td>
</tr>
<tr>
<td>production 준비 기능(상태 확인, 매트릭모니터링)</td>
<td></td>
</tr>
<tr>
<td>간결한 설정</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>스프링의 핵심</strong></p>
<p>자바의 큰 특징 - <strong>객체 지향</strong> 언어.</p>
<p>객체지향 특징을 강력하게 살려내도록 도와주는 프레임워크</p>
<ul>
<li><strong>객체 지향 특징</strong>
(<strong>추상</strong>이 <strong>캡</strong>이<strong>다</strong>)
<ul>
<li>추상화</li>
<li>캡슐화</li>
<li>다형성 - 세상은 역할과 구현으로 이루어진다. (자동차 구현체: 아반떼, 테슬라 모델3, K3)
실행 시점에 구현객체를 유연하게 변경할 수 있다.
private Car car = new K3();
→ 스프링에서 IoC, DI는 다형성을 활용해 역할과 구현을 편리하게 다룰 수 있도록 지원한다</li>
<li>상속</li>
</ul>
</li>
</ul>
<p><strong>SOLID</strong></p>
<ul>
<li>SRP: 단일 책임 원칙
한 클래스는 하나의 책임만 가져야 한다.</li>
<li>OCP: 개방폐쇄 원칙
확장에는 열려 있으나 변경에는 닫혀 있어야 한다.</li>
<li>LSP: 리스코프 치환 원칙
인터페이스와 구현체가 있다. 액셀은 앞으로 가야 한다는 규약이 있다.
구현체에서 액셀이 뒤로 가게 하면 LSP 위반이다.</li>
<li>ISP: 인터페이스 분리 원칙
인터페이스 분리</li>
<li>DI(Inversion)P: 의존관계 역전 원칙
인터페이스에 의존하라는 것. 즉, 역할과 구현에서 역할에 의존하라는 것.</li>
</ul>
<p>→ OCP, DIP 중요!</p>
<p><strong>스프링!</strong></p>
<p>→ 다형성 + OCP, DIP를 가능하게 지원한다.</p>
<ul>
<li>DI(Dependency Injection 의존관계, 의존성 주입) Container 제공</li>
</ul>
<p><strong>오늘의 정리</strong></p>
<ul>
<li>역할과 구현, 인터페이스와 구현 클래스가 중요하다.</li>
<li>인터페이스 남발하면 추상화 비용이 발생하니까 리팩토링할 때 인터페이스 도입하는 것도 좋다.</li>
</ul>
<h2 id="1-스프링-핵심-원리-이해1---예제-만들기">1. 스프링 핵심 원리 이해1 - 예제 만들기</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled.png"
        data-srcset="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled.png, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled.png 1.5x, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled.png 2x"
        data-sizes="auto"
        alt="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled.png"
        title="Untitled" /></p>
<p>실무에서는 HashMap → <code>ConcurrentHashMap</code></p>
<p>프레임워크: JUnit처럼 내가 작성한 코드를 제어하고 대신 실행해준다.
라이브러리: 내가 작성한 코드가 제어의 흐름을 담당한다면 라이브러리</p>
<p>AppConfig처럼 객체를 생성하고 관리하면서 의존관계를 연결해주는 것은 <strong><code>IoC 컨테이너</code></strong> 혹은 **<code>DI 컨테이너</code>**라고 한다. 또는 어셈블러, <strong>오브젝트 팩토리</strong> 등으로 불리기도 한다.</p>
<p>프로그램의 제어 흐름을 외부에서 관리하게 하는 것을 IoC 라고 한다. ex) IoC</p>
<h2 id="2-스프링-핵심-원리-이해2---객체-지향-원리-적용">2. <strong>스프링 핵심 원리 이해2 - 객체 지향 원리 적용</strong></h2>
<ul>
<li>
<p><code>@Configuration</code>: 설정 정보</p>
</li>
<li>
<p><code>@Bean</code>: 해당 어노테이션이 붙은 메서드를 모두 호출해서 반환된 객체를 <code>스프링 컨테이너에 등록</code>된다.
(<code>applicationContext.getBean</code>으로 <strong>스프링 빈</strong> 객체를 찾을 수 있다.)</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%201.png"
        data-srcset="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%201.png, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%201.png 1.5x, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%201.png 2x"
        data-sizes="auto"
        alt="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%201.png"
        title="Untitled" /></p>
<p>아래 예시를 보면
(왼쪽) Bean으로 등록했기 때문에 + 인터페이스에 구현체를 넣어줌으로써 원하는 <code>가격 정책</code>을 결정할 수 O
(오른쪽) 사용처에서 알아서 가져와서 등록할 수 있음을 알 수 있다.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%202.png"
        data-srcset="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%202.png, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%202.png 1.5x, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%202.png 2x"
        data-sizes="auto"
        alt="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%202.png"
        title="Untitled" /></p>
</li>
</ul>
<h2 id="3-스프링-컨테이너와-스프링-빈">3. <strong>스프링 컨테이너와 스프링 빈</strong></h2>
<ul>
<li>
<p>스프링 컨테이너</p>
<p>ApplicationContext를 스프링 컨테이너라고 한다.</p>
<p>BeanFactory는 ApplicationContext의 상위 인터페이스다.(최상위 인터페이스) - getBean 제공
<code>ApplicationContext = BeanFactory 기능 + 여러 부가 기능</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">AnnotationConfigApplicationContext</span> <span class="n">ac</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="n">AppConfig</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="n">1</span><span class="o">.</span> <span class="n">모든</span> <span class="n">빈</span> <span class="n">출력</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">beanDefinitionNames</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="na">getBeanDefinitionNames</span><span class="o">();</span>

<span class="n">2</span><span class="o">.</span> <span class="n">직접</span> <span class="n">등록한</span> <span class="n">빈인지</span> <span class="n">확인</span>
<span class="nf">if</span><span class="o">(</span><span class="n">beanDefinition</span><span class="o">.</span><span class="na">getRole</span><span class="o">()</span> <span class="o">==</span> <span class="n">BeanDefinition</span><span class="o">.</span><span class="na">ROLE_APPLICATION</span><span class="o">)</span>

<span class="n">3</span><span class="o">.</span> <span class="n">빈</span> <span class="n">객체</span> <span class="n">조회</span>
<span class="n">ac</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="n">빈이름</span><span class="o">,</span> <span class="n">타입</span><span class="o">)</span> <span class="o">/</span> <span class="o">(</span><span class="n">타입</span><span class="o">)</span>
<span class="n">ex</span><span class="o">)</span> <span class="n">ac</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;memberService&#34;</span><span class="o">,</span><span class="n">MemberService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="n">4</span><span class="o">.</span> <span class="n">특정</span> <span class="n">타입</span> <span class="n">빈</span> <span class="n">모두</span> <span class="n">조회</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">MemberRepository</span><span class="o">&gt;</span> <span class="n">beansOfType</span> <span class="o">=</span>
	<span class="n">ac</span><span class="o">.</span><span class="na">getBeansOfType</span><span class="o">(</span><span class="n">MemberRepository</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="n">5</span><span class="o">.</span> <span class="n">부모</span> <span class="n">타입으로</span> <span class="n">조회시</span><span class="o">,</span> <span class="n">자식이</span> <span class="n">둘</span> <span class="n">이상</span> <span class="n">있으면</span><span class="o">,</span> <span class="n">중복</span> <span class="n">오류가</span> <span class="n">발생</span>
<span class="nf">assertThrows</span><span class="o">(</span><span class="n">NoUniqueBeanDefinitionException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span>
	<span class="n">ac</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="n">DiscountPolicy</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>

<span class="n">6</span><span class="o">.</span> <span class="n">부모</span> <span class="n">타입으로</span> <span class="n">조회시</span><span class="o">,</span> <span class="n">자식이</span> <span class="n">둘</span> <span class="n">이상</span> <span class="n">있으면</span><span class="o">,</span> <span class="n">빈</span> <span class="n">이름을</span> <span class="n">지정하면</span> <span class="n">된다</span>
<span class="n">DiscountPolicy</span> <span class="n">rateDiscountPolicy</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;rateDiscountPolicy&#34;</span><span class="o">,</span>
	<span class="n">DiscountPolicy</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">assertThat</span><span class="o">(</span><span class="n">rateDiscountPolicy</span><span class="o">).</span><span class="na">isInstanceOf</span><span class="o">(</span><span class="n">RateDiscountPolicy</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>위에는 어노테이션 방식. 원한다면 아래처럼 xml 방식을 사용 가능</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">ApplicationContext</span> <span class="n">ac</span> <span class="o">=</span> <span class="k">new</span>
  <span class="n">GenericXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;appConfig.xml&#34;</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>스프링은 어떻게 xml, 어노테이션 설정 형식을 지원할까?
<code>BeanDefinition</code>이라는 <code>추상화</code>를 알아보자
→ <code>빈 설정 메타정보</code>, @Bean, <bean>당 각각 하나씩 메타 정보 생성</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%203.png"
        data-srcset="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%203.png, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%203.png 1.5x, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%203.png 2x"
        data-sizes="auto"
        alt="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%203.png"
        title="Untitled" /></p>
<p><code>AnnotatedBeanDefinitionReader</code>, <code>XmlBeanDefinitionReader</code>을 사용해서
AppConfig.class를 읽고 <code>BeanDefinition</code>을 생성한다.</p>
</li>
<li>
<p>BeanDefinition</p>
<ul>
<li>BeanClassName</li>
<li>factoryBeanName (ex) appConfig)</li>
<li>factoryMethodName (ex) memberService)</li>
<li>Scope (기본값 = 싱글톤)</li>
<li>lazyInit (실제 빈을 사용할 때까지 최대한 생성을 지연처리하는 지에 대한 여부)</li>
<li>InitMethodName: 빈을 생성하고, 의존관계 적용 후 호출되는 초기화 메서드명</li>
<li>DestroyMethodName: 빈 생명주기 끝나고 제거하기 직전 호출되는 메서드명</li>
<li>Constructor arguments, Properties: 의존관계 주입에서 사용된다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">String</span><span class="o">[]</span> <span class="n">beanDefinitionNames</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="na">getBeanDefinitionNames</span><span class="o">();</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="4-싱글톤-컨테이너">4. <strong>싱글톤 컨테이너</strong></h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%204.png"
        data-srcset="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%204.png, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%204.png 1.5x, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%204.png 2x"
        data-sizes="auto"
        alt="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%204.png"
        title="Untitled" /></p>
<p>요청 올 때마다 서비스를 만들면 무리가 될 수 있다.(메모리 낭비)</p>
<h3 id="싱글톤-패턴">싱글톤 패턴</h3>
<p>클래스의 인스턴스가 딱 1개만 생성되는 것을 보장하는 디자인 패턴이다.</p>
<p><code>private 생성자</code>를 사용해서 외부에서 new를 사용하지 못하게 한다.
사용 방법은 아래와 같다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SingletonService</span> <span class="o">{</span>
	<span class="c1">//1. static 영역에 객체를 딱 1개만 생성
</span><span class="c1"></span>	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">SingletonService</span> <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SingletonService</span><span class="o">();</span>

	<span class="c1">//2. 이 static 메서드를 통해서만 조회하도록 허용
</span><span class="c1"></span>  <span class="kd">public</span> <span class="kd">static</span> <span class="n">SingletonService</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="c1">//3. 생성자를 private으로 선언해서 외부에서 new 키워드를 사용한 객체 생성을 못하게 막는다. 
</span><span class="c1"></span>	<span class="kd">private</span> <span class="nf">SingletonService</span><span class="o">()</span> <span class="o">{}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">logic</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;싱글톤 객체 로직 호출&#34;</span><span class="o">);</span>
	<span class="o">}</span> 
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>싱글톤 패턴 문제점</strong></p>
<ul>
<li>싱글톤 패턴을 구현하는 코드 자체가 많이 들어간다.</li>
<li>의존관계상 클라이언트가 구체 클래스에 의존한다. DIP를 위반한다.</li>
<li>클라이언트가 구체 클래스에 의존해서 OCP 원칙을 위반할 가능성이 높다.</li>
<li>테스트하기 어렵다. → 안티패턴</li>
<li>서버 환경에서는 싱글톤이 1개만 생성됨을 보장하지 못한다.</li>
<li>내부 속성을 변경하거나 초기화 하기 어렵다.</li>
<li>private 생성자로 있어서 상속이 불가능하다.</li>
<li>결론적으로 유연성이 떨어진다.</li>
<li>안티패턴으로 불리기도 한다.</li>
</ul>
<h3 id="싱글톤-컨테이너">싱글톤 컨테이너</h3>
<p><code>스프링 컨테이너</code>는 싱글톤 패턴의 문제점을 해결하면서, 객체 인스턴스를 싱글톤(1개만 생성)으로
관리한다.
학습한 스프링 빈 = 바로 싱글톤으로 관리되는 빈</p>
<ul>
<li>
<p>스프링 컨테이너는 싱글턴 패턴을 적용하지 않아도, <code>객체 인스턴스를 싱글톤</code>으로 관리</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%205.png"
        data-srcset="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%205.png, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%205.png 1.5x, %E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%205.png 2x"
        data-sizes="auto"
        alt="%E1%84%89%E1%85%B3%E1%84%91%E1%85%B3%E1%84%85%E1%85%B5%E1%86%BC%20%E1%84%92%E1%85%A2%20f747b/Untitled%205.png"
        title="Untitled" /></p>
<p>→ 싱글톤 컨테이너 역할
→ 지저분한 코드가 들어가지 않아도 된다
→ <code>DIP, OCP, 테스트, private 생성자</code>로 부터 자유롭게 싱글톤을 사용 가능
: 학습한 memberService, memberRepository 싱글톤 가능</p>
</li>
</ul>
<h3 id="주의점">주의점</h3>
<ul>
<li><code>stateless</code>로 설계해야 한다.
<ul>
<li>의존적인 필드가 있으면 안 된다.</li>
<li>클라이언트가 값을 변경할 수 있는 필드가 있으면 안 된다.</li>
<li>가급적 <code>읽기만 가능하게</code> 해야 한다.</li>
<li>필드 대신, 자바에서 공유되지 않는 <code>지역변수</code>, <code>파라미터</code>, <code>스레드로컬</code> 등을 사용해야 한다.
→왜? <code>공유필드</code>를 조심해야 한다.(동시성 문제)
예를 들어 사용자A의 주문금액은 10000원이 되어야 하는데, 20000원이라는 결과가 나올 수 있다.</li>
</ul>
</li>
</ul>
<h3 id="configuration과-싱글톤"><strong>@Configuration과 싱글톤</strong></h3>
<p>아래 코드를 봤을 때, memberRepository가 2개 사용되니까 싱글톤이 깨지는 것처럼 볼 수도 있다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppConfig</span> <span class="o">{</span>
      <span class="nd">@Bean</span>
      <span class="kd">public</span> <span class="n">MemberService</span> <span class="nf">memberService</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="n">MemberServiceImpl</span><span class="o">(</span><span class="n">memberRepository</span><span class="o">());</span>
      <span class="o">}</span>
      <span class="nd">@Bean</span>
      <span class="kd">public</span> <span class="n">OrderService</span> <span class="nf">orderService</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="n">OrderServiceImpl</span><span class="o">(</span>
                  <span class="n">memberRepository</span><span class="o">(),</span>
                  <span class="n">discountPolicy</span><span class="o">());</span>
			<span class="o">}</span>
      <span class="nd">@Bean</span>
      <span class="kd">public</span> <span class="n">MemberRepository</span> <span class="nf">memberRepository</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="k">new</span> <span class="n">MemoryMemberRepository</span><span class="o">();</span>
      <span class="o">}</span>
<span class="o">...</span> <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>위에 언급했듯, <code>스프링 컨테이너 = 싱글톤 레지스트리</code>
→ 스프링 빈이 <code>싱글톤</code>이 되도록 보장해주어야 한다.
그래서 모든 비밀은 <code>@Configuration</code> 을 적용한 AppConfig 에 있다. → 스프링 빈이 된다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">configurationDeep</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">ApplicationContext</span> <span class="n">ac</span> <span class="o">=</span> <span class="k">new</span>
		  <span class="n">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="n">AppConfig</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="c1">//AppConfig도 스프링 빈으로 등록된다.
</span><span class="c1"></span>	<span class="n">AppConfig</span> <span class="n">bean</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="n">AppConfig</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;bean = &#34;</span> <span class="o">+</span> <span class="n">bean</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
	<span class="c1">//출력: bean = class hello.core.AppConfig$$EnhancerBySpringCGLIB$$bd479d70
</span><span class="c1"></span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>@Configuration 을 붙이면 바이트코드를 조작하는 CGLIB 기술을 사용해서 싱글톤을 보장!</p>
<p>아마 CGLIB이 아래처럼 해줄 것</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="n">MemberRepository</span> <span class="nf">memberRepository</span><span class="o">()</span> <span class="o">{</span>
	<span class="k">if</span> <span class="o">(</span><span class="n">memoryMemberRepository가</span> <span class="n">이미</span> <span class="n">스프링</span> <span class="n">컨테이너에</span> <span class="n">등록되어</span> <span class="n">있으면</span><span class="o">?)</span> <span class="o">{</span> 
		<span class="k">return</span> <span class="n">스프링</span> <span class="n">컨테이너에서</span> <span class="n">찾아서</span> <span class="n">반환</span><span class="o">;</span>
	<span class="o">}</span> <span class="k">else</span> <span class="o">{</span> <span class="c1">//스프링 컨테이너에 없으면
</span><span class="c1"></span>		<span class="n">기존</span> <span class="n">로직을</span> <span class="n">호출해서</span> <span class="n">MemoryMemberRepository를</span> <span class="n">생성하고</span> <span class="n">스프링</span> <span class="n">컨테이너에</span> <span class="n">등록</span> <span class="k">return</span> <span class="n">반환</span>
	<span class="o">}</span> 
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="configuration-을-적용하지-않고-bean-만-적용하면-어떻게-될까"><strong>@Configuration 을 적용하지 않고, @Bean 만 적용하면 어떻게 될까?</strong></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">call</span> <span class="n">AppConfig</span><span class="o">.</span><span class="na">memberService</span>
<span class="n">call</span> <span class="n">AppConfig</span><span class="o">.</span><span class="na">memberRepository</span>
<span class="n">call</span> <span class="n">AppConfig</span><span class="o">.</span><span class="na">orderService</span>
<span class="n">call</span> <span class="n">AppConfig</span><span class="o">.</span><span class="na">memberRepository</span>
<span class="n">call</span> <span class="n">AppConfig</span><span class="o">.</span><span class="na">memberRepository</span>

<span class="n">memberService</span> <span class="o">-&gt;</span> <span class="n">memberRepository</span> <span class="o">=</span>
	<span class="n">hello</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">member</span><span class="o">.</span><span class="na">MemoryMemberRepository</span><span class="nd">@6239aba6</span>
<span class="n">orderService</span> <span class="o">-&gt;</span> <span class="n">memberRepository</span>  <span class="o">=</span>
	<span class="n">hello</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">member</span><span class="o">.</span><span class="na">MemoryMemberRepository</span><span class="nd">@3e6104fc</span>
<span class="n">memberRepository</span> <span class="o">=</span> 
	<span class="n">hello</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">member</span><span class="o">.</span><span class="na">MemoryMemberRepository</span><span class="nd">@12359a82</span>
</code></pre></td></tr></table>
</div>
</div><p>각각 다 다른 MemoryMemberRepository를 가진다. → 싱글톤 X</p>
<ul>
<li>@Bean만 사용해도 <code>스프링 빈으로 등록</code>되지만, <code>싱글톤을 보장하지 않는다</code>.
memberRepository() 처럼 의존관계 주입이 필요해서 메서드를 직접 호출할 때 싱글톤을 보장하지 않는다.</li>
</ul>
<h2 id="5-컴포넌트-스캔">5. 컴포넌트 스캔</h2>
<p>스프링은 설정 정보가 없어도 <code>자동으로 스프링 빈을 등록</code>하는 컴포넌트 스캔이라는 <code>기능</code>을 제공한다.</p>
<p>컴포넌트 스캔을 사용하려면 <code>ComponentScan</code>을 붙여주면 된다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="o">(</span>
        <span class="n">excludeFilters</span> <span class="o">=</span> <span class="nd">@Filter</span><span class="o">(</span><span class="n">type</span> <span class="o">=</span> <span class="n">FilterType</span><span class="o">.</span><span class="na">ANNOTATION</span><span class="o">,</span> <span class="n">classes</span> <span class="o">=</span>
<span class="n">Configuration</span><span class="o">.</span><span class="na">class</span><span class="o">))</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AutoAppConfig</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>위 예제에서는 @Configuration이 붙은 설정 정보가 자동으로 등록되어서,</p>
<p><code>excludeFilters</code>를 사용하여 컴포넌트 스캔 대상에서 제외 가능
<code>basePackages</code> 탐색할 분위기의 시작 위치 지정 가능
<code>basePackageClasses</code> 지정한 클래스의 패키지를 탐색 시작 위치로 지정</p>
<p><code>@Autowired</code> 는 의존관계를 자동으로 주입 가능</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Component</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderServiceImpl</span> <span class="kd">implements</span> <span class="n">OrderService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">DiscountPolicy</span> <span class="n">discountPolicy</span><span class="o">;</span>
		<span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">OrderServiceImpl</span><span class="o">(</span><span class="n">MemberRepository</span> <span class="n">memberRepository</span><span class="o">,</span> <span class="n">DiscountPolicy</span>
															<span class="n">discountPolicy</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">memberRepository</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">discountPolicy</span> <span class="o">=</span> <span class="n">discountPolicy</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>@Component</code>가 붙은 모든 클래스를 스프링 빈으로 등록한다.</p>
<h3 id="컴포넌트-스캔-기본-대상">컴포넌트 스캔 기본 대상</h3>
<ul>
<li>@Component</li>
<li>@Controller</li>
<li>@Service</li>
<li>@Repository</li>
<li>@Configuration: 스프링 설정 정보로 인식하고, 스프링 빈이 싱글톤을 유지하도록 추가 처리</li>
</ul>
<blockquote>
<p>필터
• useDefaultFilters: 이 옵션을 끄면 기본 스캔 대상들 제외
• includeFilters: 스캔 대상 추가 지정
• excludeFilters: 스캔 제외 대상 추가 지정</p>
</blockquote>
<p>스캔 대상에 추가/제외할 애노테이션</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Target</span><span class="o">(</span><span class="n">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">MyIncludeComponent</span> <span class="o">{</span>
<span class="o">}</span>

<span class="nd">@Target</span><span class="o">(</span><span class="n">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">MyExcludeComponent</span> <span class="o">{</span>
<span class="o">}</span>

<span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="o">(</span>
    <span class="n">includeFilters</span> <span class="o">=</span> <span class="nd">@Filter</span><span class="o">(</span><span class="n">type</span> <span class="o">=</span> <span class="n">FilterType</span><span class="o">.</span><span class="na">ANNOTATION</span><span class="o">,</span> 
					<span class="n">classes</span> <span class="o">=</span> <span class="n">MyIncludeComponent</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
    <span class="n">excludeFilters</span> <span class="o">=</span> <span class="nd">@Filter</span><span class="o">(</span><span class="n">type</span> <span class="o">=</span> <span class="n">FilterType</span><span class="o">.</span><span class="na">ANNOTATION</span><span class="o">,</span> 
					<span class="n">classes</span> <span class="o">=</span> <span class="n">MyExcludeComponent</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="o">)</span>
<span class="kd">static</span> <span class="kd">class</span> <span class="nc">ComponentFilterAppConfig</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>FilterType은 5가지 옵션이 있다.</p>
<ul>
<li>ANNOTATION</li>
<li>ASSIGNABLE_TYPE</li>
<li>ASPECTJ</li>
<li>REGEX</li>
<li>CUSTOM</li>
</ul>
<p>스프링 빈이 등록될 때, 빈 이름이 같은 게 2개 있을 경우(<code>자동빈 vs 자동빈</code>),
<code>ConflictingBeanDefinitionException</code> 예외 발생 가능</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Bean</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#34;memoryMemberRepository&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">MemberRepository</span> <span class="nf">memberRepository</span><span class="o">()</span> <span class="o">{</span>
   <span class="k">return</span> <span class="k">new</span> <span class="n">MemoryMemberRepository</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>자동 빈 vs 수동 빈</code> 일 경우, 수동빈 등록이 우선권을 가져, <code>자동 빈을 오버라이딩</code> 한다.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2022-04-14</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/spring-core1/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/spring/">spring</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/effective-java/" class="prev" rel="prev" title="이펙티브 자바 1~30"><i class="fas fa-angle-left fa-fw"></i>이펙티브 자바 1~30</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.92.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/h3yon" target="_blank">h3yon</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
